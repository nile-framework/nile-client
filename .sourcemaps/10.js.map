{"version":3,"sources":["../../src/pages/new-job-site/new-job-site.module.ts","../../src/pages/new-job-site/new-job-site.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import { NgModule } from '@angular/core';\n\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { NewJobSitePage } from './new-job-site';\n\n@NgModule({\n  declarations: [\n    NewJobSitePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(NewJobSitePage),\n    TranslateModule.forChild()\n  ],\n})\nexport class NewJobSitePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/new-job-site/new-job-site.module.ts","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\n\nimport { IonicPage, NavController, NavParams, Loading, AlertController, LoadingController } from 'ionic-angular';\n\nimport { AngularFireDatabase } from 'angularfire2/database';\n\nimport { AuthProvider } from '../../providers/auth/auth';\n\ndeclare var goolge: any;\n\n\n\n@IonicPage()\n@Component({\n  selector: 'page-new-job-site',\n  templateUrl: 'new-job-site.html',\n})\nexport class NewJobSitePage implements OnInit {\n\n  companyId;\n\n  autocompleteItems: any;\n  autocomplete: any;\n  acService: google.maps.places.AutocompleteService;\n  placesService: google.maps.places.PlacesService;\n  @ViewChild(\"emptyDiv\") map: any;\n\n  form: FormGroup;\n\n  itemSelected: boolean = false;\n\n  public loading: Loading;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private _fb: FormBuilder,\n    public alertCtrl: AlertController,\n    public loadingCtrl: LoadingController,\n    private _afDb: AngularFireDatabase,\n    private _auth: AuthProvider\n    )\n  {\n    this.buildForm();\n    // subscribe to the company Id from within the auth provider.\n    this._auth.companyId.subscribe( companyId => {\n      this.companyId = companyId;\n    })\n  }\n\n  ngOnInit() {\n    this.acService = new google.maps.places.AutocompleteService();\n    this.autocompleteItems = [];\n    this.autocomplete = {\n      query: ''\n    }\n    this.initMap();\n  }\n\n  initMap() {\n    let divMap = (<HTMLInputElement>document.getElementById('map'));\n    this.map = new google.maps.Map(divMap, { })\n  }\n\n  saveJobSite() {\n    // add the job site the list of job sites in the databse for the right companies node\n    this._afDb.list(`/jobSites/${this.companyId}`).push({\n      name: this.form.value.name,\n      address: this.form.value.address,\n      notes: this.form.value.notes,\n      accessCode: this.form.value.accessCode,\n      placeId: this.form.value.placeId\n    }).then( snapshot => {\n      this.loading.dismiss().then( _ => {\n        // remember that we are altering the navigation stack for the Job-Sites tab item.\n        this.navCtrl.setRoot('JobSitesPage');\n      });\n    }, error => {\n      this.loading.dismiss().then( _ => {\n        let alert = this.alertCtrl.create({\n          title: error.name,\n          subTitle: error.message,\n          buttons: ['OK']\n        });\n        alert.present();\n      })\n    })\n\n    this.loading = this.loadingCtrl.create();\n    this.loading.present();\n  }\n\n\n  chooseItem(item: any) {\n    // process item\n    // 1. Hide the searchbar and display the job site creation form.\n    this.itemSelected = true;\n    // 2. fetch the place details and insert them into the form.\n    this.getPlaceDetails(item.place_id)\n  }\n\n  updateSearch() {\n    if (this.autocomplete.query === '') {\n      this.autocompleteItems = [];\n      return;\n    }\n\n    let self = this;\n    let config = {\n      // types: ['']\n      input: this.autocomplete.query,\n      componentRestrictions: { country: 'US'}\n    }\n    this.acService.getPlacePredictions(config, (predections, status) => {\n      self.autocompleteItems = [];\n      predections.forEach( predection => {\n        self.autocompleteItems.push(predection);\n      });\n    });\n  }\n\n  buildForm() {\n    this.form = this._fb.group({\n      name: ['', Validators.required],\n      address: ['', Validators.required],\n      accessCode: [''],\n      notes: [''],\n      placeId: ['']\n    });\n  }\n\n\n\n  cancel() {\n    let confirm = this.alertCtrl.create({\n      title: 'Cancel this job-site?',\n      message: 'Are you sure you want to cancel creating this job site? None of the information you may have filled out will be saved.',\n      buttons: [\n        {\n          text: 'Nevermind',\n          handler: () => {\n            // do nothing.\n          }\n        },\n        {\n          text: 'Cancel',\n          handler: () => {\n            this.navCtrl.setRoot('JobSitesPage');\n          }\n        }\n      ]\n    });\n    confirm.present();\n  }\n\n  private getPlaceDetails(place_id: string): void {\n    var self = this;\n    var request = {\n      placeId: place_id\n    }\n    this.placesService = new google.maps.places.PlacesService(this.map);\n    this.placesService.getDetails(request, callback);\n    function callback(place: google.maps.places.PlaceResult, status) {\n      if (status === google.maps.places.PlacesServiceStatus.OK) {\n        // set address and name\n        self.form.controls['name'].setValue(place.name);\n        self.form.controls['address'].setValue(place.formatted_address);\n        self.form.controls['placeId'].setValue(place.place_id);\n      } else {\n        // hmmmm\n      }\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/new-job-site/new-job-site.ts"],"sourceRoot":""}