{"version":3,"sources":["../../src/pages/signup-credentials/signup-credentials.module.ts","../../src/pages/signup-credentials/signup-credentials.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\n\nimport { IonicPageModule } from 'ionic-angular';\n\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { SignupCredentialsPage } from './signup-credentials';\n\n@NgModule({\n  declarations: [\n    SignupCredentialsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SignupCredentialsPage),\n    TranslateModule.forChild()\n  ],\n})\nexport class SignupCredentialsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signup-credentials/signup-credentials.module.ts","import { Component } from '@angular/core';\nimport { FormBuilder, Validators, FormGroup } from '@angular/forms';\n\nimport { TranslateService } from '@ngx-translate/core';\n\nimport { AngularFireAuth } from 'angularfire2/auth';\nimport { AngularFireDatabase } from 'angularfire2/database';\nimport * as firebase from 'firebase/app';\n\nimport { IonicPage, NavController, NavParams, ToastController, Events, Loading, LoadingController, AlertController } from 'ionic-angular';\n\nimport { AuthProvider } from '../../providers/auth/auth';\n\n\n@IonicPage()\n@Component({\n  selector: 'page-signup-credentials',\n  templateUrl: 'signup-credentials.html',\n})\nexport class SignupCredentialsPage {\n\n  form: FormGroup;\n  public loading: Loading;\n\n  basicInfo: any;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public toastCtrl: ToastController,\n    public translateService: TranslateService,\n    public alertCtrl: AlertController,\n    public loadingCtrl: LoadingController,\n    private _fb: FormBuilder,\n    private _events: Events,\n    private _afAuth: AngularFireAuth,\n    private _afDb: AngularFireDatabase,\n    private _authProvider: AuthProvider\n  ) {\n    this.buildForm();\n\n    // access the information the user filled out from the previous page and save it for when the user clicks\n    // submit on this page.\n    this.basicInfo = this.navParams.get('basicInfo');\n  }\n\n  ionViewDidLoad() {\n    \n  }\n  // Construct the form that contains the users login credentails.\n  buildForm() {\n    this.form = this._fb.group({\n      email: ['', Validators.email],\n      password: ['', Validators.minLength(6)],\n      verifyPassword: ['', Validators.required]\n    });\n  }\n\n  onSubmit() {\n    if (this.form.value.password === this.form.value.verifyPassword) {\n      // passwords match, lets continue\n      this._authProvider.signUpWithEmail(\n        this.form.value.email,\n        this.form.value.password,\n        this.basicInfo.phoneNumber,\n        this.basicInfo.firstName,\n        this.basicInfo.lastName\n      ).then( user => {\n        this.loading.dismiss().then( _ => {\n          // this.navCtrl.setRoot('TabsPage').then( _ => {\n            // activate the correct side navigation menu.\n            this._events.publish('menu:enable');\n            // display a success message to the user.\n            let toast = this.toastCtrl.create({\n              message: 'Account successfully created',\n              duration: 3000,\n              position: 'middle'\n            });\n            toast.present();\n            // we need to move this to a better location or change the process somehow (possibly cloud functions)\n            this._afDb.list(`/companies`).push({\n              owner: {\n                [this._afAuth.auth.currentUser.uid]: true\n              },\n              authState: 'initialSetup'\n            }).then( snapshot => {\n              this._afDb.object(`users/${this._afAuth.auth.currentUser.uid}`).update({\n                company: {\n                  id: snapshot.key,\n                  position: 'owner',\n                  authorized: false\n                }\n              })\n              console.log('snapshot is ' + snapshot);\n              console.dir(snapshot);\n            })\n          });\n        // });\n      }, error => {\n        this.loading.dismiss().then( _ => {\n          let alert = this.alertCtrl.create({\n            title: error.name,\n            subTitle: error.message,\n            buttons: ['OK']\n          });\n          alert.present();\n        });\n      });\n    } else {\n      // passwords don't match\n      this.loading.dismiss().then( _ => {\n        let toast = this.toastCtrl.create({\n          message: 'Passwords did not match.',\n          duration: 2500,\n          position: 'middle'\n        });\n        toast.present();\n      })\n    }\n\n    this.loading = this.loadingCtrl.create();\n    this.loading.present();\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signup-credentials/signup-credentials.ts"],"sourceRoot":""}